{"ast":null,"code":"import * as StellarSdk from '@stellar/stellar-sdk';\nconst TESTNET = true;\nconst SERVER_URL = TESTNET ? 'https://horizon-testnet.stellar.org' : 'https://horizon.stellar.org';\nconst NETWORK_PASSPHRASE = TESTNET ? StellarSdk.Networks.TESTNET : StellarSdk.Networks.PUBLIC;\nclass StellarService {\n  constructor() {\n    this.server = new StellarSdk.Horizon.Server(SERVER_URL);\n    this.freighterAvailable = false;\n    this.publicKey = null; // set after connecting to Freighter\n    // Detect Freighter on window - modern freighter exposes `window.freighterApi`\n    if (typeof window !== 'undefined') {\n      this.freighterAvailable = !!(window.freighterApi || window.freighter);\n    }\n  }\n\n  // legacy method that signs with a secret key (kept for tests/admins)\n  async createTimeLock(secretKey, amount, lockPeriodDays) {\n    try {\n      const sourceKeypair = StellarSdk.Keypair.fromSecret(secretKey);\n      const sourcePublicKey = sourceKeypair.publicKey();\n\n      // Load account\n      const account = await this.server.loadAccount(sourcePublicKey);\n\n      // Calculate unlock time\n      const unlockTime = Math.floor(Date.now() / 1000) + lockPeriodDays * 24 * 60 * 60;\n\n      // Build transaction\n      const transaction = new StellarSdk.TransactionBuilder(account, {\n        fee: StellarSdk.BASE_FEE,\n        networkPassphrase: NETWORK_PASSPHRASE\n      }).addOperation(StellarSdk.Operation.payment({\n        destination: sourcePublicKey,\n        asset: StellarSdk.Asset.native(),\n        amount: amount.toString()\n      })).addMemo(StellarSdk.Memo.text(`TIMELOCK:${unlockTime}`)).setTimeout(30).build();\n\n      // Sign and submit\n      transaction.sign(sourceKeypair);\n      const result = await this.server.submitTransaction(transaction);\n      return result.hash;\n    } catch (error) {\n      console.error('Stellar transaction error:', error);\n      throw new Error(error.message || 'Failed to create time-lock');\n    }\n  }\n\n  // legacy withdraw using secret key\n  async withdraw(secretKey, amount) {\n    try {\n      const sourceKeypair = StellarSdk.Keypair.fromSecret(secretKey);\n      const sourcePublicKey = sourceKeypair.publicKey();\n      const account = await this.server.loadAccount(sourcePublicKey);\n      const transaction = new StellarSdk.TransactionBuilder(account, {\n        fee: StellarSdk.BASE_FEE,\n        networkPassphrase: NETWORK_PASSPHRASE\n      }).addOperation(StellarSdk.Operation.payment({\n        destination: sourcePublicKey,\n        asset: StellarSdk.Asset.native(),\n        amount: amount.toString()\n      })).addMemo(StellarSdk.Memo.text('WITHDRAW')).setTimeout(30).build();\n      transaction.sign(sourceKeypair);\n      const result = await this.server.submitTransaction(transaction);\n      return result.hash;\n    } catch (error) {\n      console.error('Withdrawal error:', error);\n      throw new Error(error.message || 'Failed to withdraw');\n    }\n  }\n\n  // ---------- Freighter integration ----------\n  isFreighterAvailable() {\n    return this.freighterAvailable;\n  }\n  async connectFreighter() {\n    if (!this.isFreighterAvailable()) {\n      throw new Error('Freighter wallet not detected. Please install Freighter.');\n    }\n    try {\n      // Modern Freighter exposes `window.freighterApi.getPublicKey()`\n      if (window.freighterApi && typeof window.freighterApi.getPublicKey === 'function') {\n        this.publicKey = await window.freighterApi.getPublicKey();\n      } else if (window.freighter && typeof window.freighter.getPublicKey === 'function') {\n        this.publicKey = await window.freighter.getPublicKey();\n      } else {\n        throw new Error('Freighter provider found but does not expose getPublicKey()');\n      }\n      return this.publicKey;\n    } catch (err) {\n      console.error('Failed to connect to Freighter:', err);\n      throw err;\n    }\n  }\n\n  // Helper to sign an unsigned Transaction (built locally) using Freighter and submit it\n  async signAndSubmitWithFreighter(transaction) {\n    if (!this.isFreighterAvailable()) {\n      throw new Error('Freighter wallet not detected.');\n    }\n\n    // Convert to XDR (base64) and request Freighter to sign\n    const txXdr = transaction.toXDR();\n    let signedXdr;\n    try {\n      // Try modern API shapes (returns signed XDR string or an object)\n      if (window.freighterApi && typeof window.freighterApi.signTransaction === 'function') {\n        const signed = await window.freighterApi.signTransaction(txXdr);\n        // signed may be a string or object\n        if (typeof signed === 'string') signedXdr = signed;else if (signed !== null && signed !== void 0 && signed.signed_transaction) signedXdr = signed.signed_transaction;else if (signed !== null && signed !== void 0 && signed.signed_envelope_xdr) signedXdr = signed.signed_envelope_xdr;else if (signed !== null && signed !== void 0 && signed.signedXDR) signedXdr = signed.signedXDR;else signedXdr = JSON.stringify(signed);\n      } else if (window.freighter && typeof window.freighter.signTransaction === 'function') {\n        const signed = await window.freighter.signTransaction(txXdr);\n        if (typeof signed === 'string') signedXdr = signed;else if (signed !== null && signed !== void 0 && signed.signed_envelope_xdr) signedXdr = signed.signed_envelope_xdr;else signedXdr = JSON.stringify(signed);\n      } else {\n        throw new Error('Freighter signing API not available');\n      }\n    } catch (err) {\n      console.error('Freighter signing failed:', err);\n      throw err;\n    }\n\n    // Submit signed envelope XDR to Horizon\n    try {\n      // If signedXdr is JSON (unexpected), throw\n      if (typeof signedXdr !== 'string') {\n        throw new Error('Unexpected signed XDR format from Freighter');\n      }\n\n      // server.submitTransaction accepts a base64 XDR string\n      const result = await this.server.submitTransaction(signedXdr);\n      return result.hash || result;\n    } catch (err) {\n      console.error('Failed to submit signed transaction:', err.response || err);\n      throw err;\n    }\n  }\n\n  // Create timelock using Freighter (no secret key in client-side code)\n  async createTimeLockWithFreighter(amount, lockPeriodDays) {\n    if (!this.publicKey) {\n      await this.connectFreighter();\n    }\n    try {\n      const sourcePublicKey = this.publicKey;\n      const account = await this.server.loadAccount(sourcePublicKey);\n      const unlockTime = Math.floor(Date.now() / 1000) + lockPeriodDays * 24 * 60 * 60;\n      const transaction = new StellarSdk.TransactionBuilder(account, {\n        fee: StellarSdk.BASE_FEE,\n        networkPassphrase: NETWORK_PASSPHRASE\n      }).addOperation(StellarSdk.Operation.payment({\n        destination: sourcePublicKey,\n        asset: StellarSdk.Asset.native(),\n        amount: amount.toString()\n      })).addMemo(StellarSdk.Memo.text(`TIMELOCK:${unlockTime}`)).setTimeout(30).build();\n      const hash = await this.signAndSubmitWithFreighter(transaction);\n      return hash;\n    } catch (error) {\n      console.error('createTimeLockWithFreighter error:', error);\n      throw error;\n    }\n  }\n  async withdrawWithFreighter(amount) {\n    if (!this.publicKey) {\n      await this.connectFreighter();\n    }\n    try {\n      const sourcePublicKey = this.publicKey;\n      const account = await this.server.loadAccount(sourcePublicKey);\n      const transaction = new StellarSdk.TransactionBuilder(account, {\n        fee: StellarSdk.BASE_FEE,\n        networkPassphrase: NETWORK_PASSPHRASE\n      }).addOperation(StellarSdk.Operation.payment({\n        destination: sourcePublicKey,\n        asset: StellarSdk.Asset.native(),\n        amount: amount.toString()\n      })).addMemo(StellarSdk.Memo.text('WITHDRAW')).setTimeout(30).build();\n      const hash = await this.signAndSubmitWithFreighter(transaction);\n      return hash;\n    } catch (error) {\n      console.error('withdrawWithFreighter error:', error);\n      throw error;\n    }\n  }\n  async getAccountBalance(publicKey) {\n    try {\n      const account = await this.server.loadAccount(publicKey);\n      const balance = account.balances.find(b => b.asset_type === 'native');\n      return parseFloat(balance.balance);\n    } catch (error) {\n      throw new Error('Failed to fetch balance');\n    }\n  }\n}\nexport default new StellarService();","map":{"version":3,"names":["StellarSdk","TESTNET","SERVER_URL","NETWORK_PASSPHRASE","Networks","PUBLIC","StellarService","constructor","server","Horizon","Server","freighterAvailable","publicKey","window","freighterApi","freighter","createTimeLock","secretKey","amount","lockPeriodDays","sourceKeypair","Keypair","fromSecret","sourcePublicKey","account","loadAccount","unlockTime","Math","floor","Date","now","transaction","TransactionBuilder","fee","BASE_FEE","networkPassphrase","addOperation","Operation","payment","destination","asset","Asset","native","toString","addMemo","Memo","text","setTimeout","build","sign","result","submitTransaction","hash","error","console","Error","message","withdraw","isFreighterAvailable","connectFreighter","getPublicKey","err","signAndSubmitWithFreighter","txXdr","toXDR","signedXdr","signTransaction","signed","signed_transaction","signed_envelope_xdr","signedXDR","JSON","stringify","response","createTimeLockWithFreighter","withdrawWithFreighter","getAccountBalance","balance","balances","find","b","asset_type","parseFloat"],"sources":["C:/Users/Ashish Dixit/OneDrive/Desktop/stellar-timelock-savings/frontend/src/services/StellarService.js"],"sourcesContent":["import * as StellarSdk from '@stellar/stellar-sdk';\r\n\r\nconst TESTNET = true;\r\nconst SERVER_URL = TESTNET \r\n  ? 'https://horizon-testnet.stellar.org'\r\n  : 'https://horizon.stellar.org';\r\n\r\nconst NETWORK_PASSPHRASE = TESTNET\r\n  ? StellarSdk.Networks.TESTNET\r\n  : StellarSdk.Networks.PUBLIC;\r\n\r\nclass StellarService {\r\n  constructor() {\r\n    this.server = new StellarSdk.Horizon.Server(SERVER_URL);\r\n    this.freighterAvailable = false;\r\n    this.publicKey = null; // set after connecting to Freighter\r\n    // Detect Freighter on window - modern freighter exposes `window.freighterApi`\r\n    if (typeof window !== 'undefined') {\r\n      this.freighterAvailable = !!(window.freighterApi || window.freighter);\r\n    }\r\n  }\r\n\r\n  // legacy method that signs with a secret key (kept for tests/admins)\r\n  async createTimeLock(secretKey, amount, lockPeriodDays) {\r\n    try {\r\n      const sourceKeypair = StellarSdk.Keypair.fromSecret(secretKey);\r\n      const sourcePublicKey = sourceKeypair.publicKey();\r\n\r\n      // Load account\r\n      const account = await this.server.loadAccount(sourcePublicKey);\r\n\r\n      // Calculate unlock time\r\n      const unlockTime = Math.floor(Date.now() / 1000) + (lockPeriodDays * 24 * 60 * 60);\r\n\r\n      // Build transaction\r\n      const transaction = new StellarSdk.TransactionBuilder(account, {\r\n        fee: StellarSdk.BASE_FEE,\r\n        networkPassphrase: NETWORK_PASSPHRASE,\r\n      })\r\n        .addOperation(\r\n          StellarSdk.Operation.payment({\r\n            destination: sourcePublicKey,\r\n            asset: StellarSdk.Asset.native(),\r\n            amount: amount.toString(),\r\n          })\r\n        )\r\n        .addMemo(StellarSdk.Memo.text(`TIMELOCK:${unlockTime}`))\r\n        .setTimeout(30)\r\n        .build();\r\n\r\n      // Sign and submit\r\n      transaction.sign(sourceKeypair);\r\n      const result = await this.server.submitTransaction(transaction);\r\n\r\n      return result.hash;\r\n    } catch (error) {\r\n      console.error('Stellar transaction error:', error);\r\n      throw new Error(error.message || 'Failed to create time-lock');\r\n    }\r\n  }\r\n\r\n  // legacy withdraw using secret key\r\n  async withdraw(secretKey, amount) {\r\n    try {\r\n      const sourceKeypair = StellarSdk.Keypair.fromSecret(secretKey);\r\n      const sourcePublicKey = sourceKeypair.publicKey();\r\n\r\n      const account = await this.server.loadAccount(sourcePublicKey);\r\n\r\n      const transaction = new StellarSdk.TransactionBuilder(account, {\r\n        fee: StellarSdk.BASE_FEE,\r\n        networkPassphrase: NETWORK_PASSPHRASE,\r\n      })\r\n        .addOperation(\r\n          StellarSdk.Operation.payment({\r\n            destination: sourcePublicKey,\r\n            asset: StellarSdk.Asset.native(),\r\n            amount: amount.toString(),\r\n          })\r\n        )\r\n        .addMemo(StellarSdk.Memo.text('WITHDRAW'))\r\n        .setTimeout(30)\r\n        .build();\r\n\r\n      transaction.sign(sourceKeypair);\r\n      const result = await this.server.submitTransaction(transaction);\r\n\r\n      return result.hash;\r\n    } catch (error) {\r\n      console.error('Withdrawal error:', error);\r\n      throw new Error(error.message || 'Failed to withdraw');\r\n    }\r\n  }\r\n\r\n  // ---------- Freighter integration ----------\r\n  isFreighterAvailable() {\r\n    return this.freighterAvailable;\r\n  }\r\n\r\n  async connectFreighter() {\r\n    if (!this.isFreighterAvailable()) {\r\n      throw new Error('Freighter wallet not detected. Please install Freighter.');\r\n    }\r\n\r\n    try {\r\n      // Modern Freighter exposes `window.freighterApi.getPublicKey()`\r\n      if (window.freighterApi && typeof window.freighterApi.getPublicKey === 'function') {\r\n        this.publicKey = await window.freighterApi.getPublicKey();\r\n      } else if (window.freighter && typeof window.freighter.getPublicKey === 'function') {\r\n        this.publicKey = await window.freighter.getPublicKey();\r\n      } else {\r\n        throw new Error('Freighter provider found but does not expose getPublicKey()');\r\n      }\r\n\r\n      return this.publicKey;\r\n    } catch (err) {\r\n      console.error('Failed to connect to Freighter:', err);\r\n      throw err;\r\n    }\r\n  }\r\n\r\n  // Helper to sign an unsigned Transaction (built locally) using Freighter and submit it\r\n  async signAndSubmitWithFreighter(transaction) {\r\n    if (!this.isFreighterAvailable()) {\r\n      throw new Error('Freighter wallet not detected.');\r\n    }\r\n\r\n    // Convert to XDR (base64) and request Freighter to sign\r\n    const txXdr = transaction.toXDR();\r\n\r\n    let signedXdr;\r\n    try {\r\n      // Try modern API shapes (returns signed XDR string or an object)\r\n      if (window.freighterApi && typeof window.freighterApi.signTransaction === 'function') {\r\n        const signed = await window.freighterApi.signTransaction(txXdr);\r\n        // signed may be a string or object\r\n        if (typeof signed === 'string') signedXdr = signed;\r\n        else if (signed?.signed_transaction) signedXdr = signed.signed_transaction;\r\n        else if (signed?.signed_envelope_xdr) signedXdr = signed.signed_envelope_xdr;\r\n        else if (signed?.signedXDR) signedXdr = signed.signedXDR;\r\n        else signedXdr = JSON.stringify(signed);\r\n      } else if (window.freighter && typeof window.freighter.signTransaction === 'function') {\r\n        const signed = await window.freighter.signTransaction(txXdr);\r\n        if (typeof signed === 'string') signedXdr = signed;\r\n        else if (signed?.signed_envelope_xdr) signedXdr = signed.signed_envelope_xdr;\r\n        else signedXdr = JSON.stringify(signed);\r\n      } else {\r\n        throw new Error('Freighter signing API not available');\r\n      }\r\n    } catch (err) {\r\n      console.error('Freighter signing failed:', err);\r\n      throw err;\r\n    }\r\n\r\n    // Submit signed envelope XDR to Horizon\r\n    try {\r\n      // If signedXdr is JSON (unexpected), throw\r\n      if (typeof signedXdr !== 'string') {\r\n        throw new Error('Unexpected signed XDR format from Freighter');\r\n      }\r\n\r\n      // server.submitTransaction accepts a base64 XDR string\r\n      const result = await this.server.submitTransaction(signedXdr);\r\n      return result.hash || result;\r\n    } catch (err) {\r\n      console.error('Failed to submit signed transaction:', err.response || err);\r\n      throw err;\r\n    }\r\n  }\r\n\r\n  // Create timelock using Freighter (no secret key in client-side code)\r\n  async createTimeLockWithFreighter(amount, lockPeriodDays) {\r\n    if (!this.publicKey) {\r\n      await this.connectFreighter();\r\n    }\r\n\r\n    try {\r\n      const sourcePublicKey = this.publicKey;\r\n      const account = await this.server.loadAccount(sourcePublicKey);\r\n\r\n      const unlockTime = Math.floor(Date.now() / 1000) + (lockPeriodDays * 24 * 60 * 60);\r\n\r\n      const transaction = new StellarSdk.TransactionBuilder(account, {\r\n        fee: StellarSdk.BASE_FEE,\r\n        networkPassphrase: NETWORK_PASSPHRASE,\r\n      })\r\n        .addOperation(\r\n          StellarSdk.Operation.payment({\r\n            destination: sourcePublicKey,\r\n            asset: StellarSdk.Asset.native(),\r\n            amount: amount.toString(),\r\n          })\r\n        )\r\n        .addMemo(StellarSdk.Memo.text(`TIMELOCK:${unlockTime}`))\r\n        .setTimeout(30)\r\n        .build();\r\n\r\n      const hash = await this.signAndSubmitWithFreighter(transaction);\r\n      return hash;\r\n    } catch (error) {\r\n      console.error('createTimeLockWithFreighter error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async withdrawWithFreighter(amount) {\r\n    if (!this.publicKey) {\r\n      await this.connectFreighter();\r\n    }\r\n\r\n    try {\r\n      const sourcePublicKey = this.publicKey;\r\n      const account = await this.server.loadAccount(sourcePublicKey);\r\n\r\n      const transaction = new StellarSdk.TransactionBuilder(account, {\r\n        fee: StellarSdk.BASE_FEE,\r\n        networkPassphrase: NETWORK_PASSPHRASE,\r\n      })\r\n        .addOperation(\r\n          StellarSdk.Operation.payment({\r\n            destination: sourcePublicKey,\r\n            asset: StellarSdk.Asset.native(),\r\n            amount: amount.toString(),\r\n          })\r\n        )\r\n        .addMemo(StellarSdk.Memo.text('WITHDRAW'))\r\n        .setTimeout(30)\r\n        .build();\r\n\r\n      const hash = await this.signAndSubmitWithFreighter(transaction);\r\n      return hash;\r\n    } catch (error) {\r\n      console.error('withdrawWithFreighter error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async getAccountBalance(publicKey) {\r\n    try {\r\n      const account = await this.server.loadAccount(publicKey);\r\n      const balance = account.balances.find(\r\n        (b) => b.asset_type === 'native'\r\n      );\r\n      return parseFloat(balance.balance);\r\n    } catch (error) {\r\n      throw new Error('Failed to fetch balance');\r\n    }\r\n  }\r\n}\r\n\r\nexport default new StellarService();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}